# ============================================
# SEO & Canonicalization Rules
# ============================================
# Goal: Ensure ALL URLs resolve to https://karnallocal.in (non-www, HTTPS)
# Order: wwwâ†’non-www FIRST, then HTTPS enforcement

RewriteEngine On

# Step 1: Redirect www to non-www (handles both HTTP and HTTPS)
# This MUST come before HTTPS enforcement to avoid double redirects
RewriteCond %{HTTP_HOST} ^www\.karnallocal\.in$ [NC]
RewriteRule ^(.*)$ https://karnallocal.in/$1 [R=301,L]

# Step 2: Force HTTPS on non-www domain only
# Only redirect if HTTPS is off AND we're on the non-www domain
RewriteCond %{HTTPS} off
RewriteCond %{HTTP_HOST} ^karnallocal\.in$ [NC]
RewriteRule ^(.*)$ https://karnallocal.in/$1 [R=301,L]

# Remove .html extension from URLs (internal rewrite for cleaner URLs)
# This allows URLs like /false-ceiling-ambala to work and serve /false-ceiling-ambala.html
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.html -f
RewriteRule ^([^/]+)/?$ $1.html [L]

# Handle directory redirects (ensure trailing slash consistency)
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^(.*[^/])$ $1/ [R=301,L]

# Redirect location subdirectories to proper paths
RewriteRule ^ambala/?$ /ambala/index.html [L]
RewriteRule ^assandh/?$ /assandh/index.html [L]
RewriteRule ^panipat/?$ /panipat/index.html [L]
RewriteRule ^kurukshetra/?$ /kurukshetra/index.html [L]
